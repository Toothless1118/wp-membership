!function(a){function b(b,c){var d=new Image;d.src=c,d.complete?b.css("background-image",'url("'+c+'")'):(b.css("background-image","url('images/wpspin_light.gif')"),a(d).load(function(){b.css("background-image",'url("'+c+'")')}))}var c=function(b){function c(b){var c=g.$t.find(".provider_list_select");c.empty().after('<img class="op-bsw-waiting" src="images/wpspin_light.gif" alt="loading" style="position:relative;display:block;top:4px">'),a.post(OptimizePress.ajaxurl,{action:OptimizePress.SN+"-email-provider-items",provider:b},function(d){switch(g.lists=d.lists,b){case"infusionsoft":case"aweber":case"mailchimp":case"mailpoet":case"emma":case"egoi":case"maropost":case"icontact":case"getresponse":case"campaignmonitor":case"constantcontact":case"convertkit":case"officeautopilot":case"activecampaign":case"ontraport":var e=[];a.each(d.lists,function(b,c){e.push(a("<option/>",{value:b,text:c.name}))}),e.sort(function(a,b){return a.text().toLowerCase()>b.text().toLowerCase()?1:-1}),c.empty().append(e)}c.next().remove(),"undefined"!=typeof c.attr("data-default")&&c.val(c.attr("data-default")),c.trigger("change")},"json")}function d(b){var b=a(b),c=g.$t.find(b.hasClass("name_select")?".email_select":".name_select"),d=b.val(),e=c.val();d==e&&c.find('option[value!="'+d+'"]:eq(0)').attr("selected",!0)}function e(){var b='<option value="op_add_new_field">'+op_mod_signup_form.lang.add_new_field+'</option><option value="">-----------------</option>';a.each(g.input_elems,function(a,c){b+='<option value="'+a+'">'+c+"</option>"}),g.els.extra_fields.find("select").each(function(c){var d=a(this).find(":selected").attr("value");a(this).html(b).val(d).trigger("change")})}function f(b,c){g.input_elems=g.lists[b].fields,"undefined"!=typeof g.lists[b]&&"undefined"!=typeof g.lists[b].action&&g.$t.find(".action_page input").val(g.lists[b].action),"undefined"!=typeof g.lists[b]&&"undefined"!=typeof g.lists[b].hidden&&a.each(g.lists[b].hidden,function(b,c){g.hdn_div.empty(),g.hdn_div.append(a('<input type="hidden" name="'+g.prefix+'[fields][field_name][]" />').val(b)),g.hdn_div.append(a('<input type="hidden" name="'+g.prefix+'[fields][field_vals][]" />').val(c))});var d=[];a.each(g.input_elems,function(b,c){d.push(a("<option/>",{value:b,text:c}))});var f=g.$t.find(".name_select");if(f.empty().append(d),f.val(g.els.name_selected),""==g.els.name_selected){var h=null;switch(c){case"activecampaign":case"arpreach":case"constantcontact":case"egoi":case"emma":case"maropost":h="first_name";break;case"campaignmonitor":h="Name";break;case"aweber":case"convertkit":case"getresponse":case"icontact":h="name";break;case"officeautopilot":case"ontraport":h="First-Name";break;case"infusionsoft":h="inf_field_FirstName";break;case"mailchimp":h="FNAME";break;case"mailpoet":h="firstname"}h&&f.val(h)}e()}var g=this;g.$t=b,g.tmp_obj=a("<div />"),g.selects=b.find(".field_select").change(function(){d(this)}),g.hdn_div=b.find(".hidden-div"),g.prefix=b.find(".field_prefix").val(),g.idprefix=b.find(".field_idprefix").val(),g.input_elems={},g.lists={},g.els={email_select:b.find(".email_select"),email_selected:b.find(".email_box_selected").val(),name_select:b.find(".name_select"),name_selected:b.find(".name_box_selected").val(),action:b.find(".form_action"),method:b.find(".method_select"),extra_fields:b.find(".extra_fields .op-multirow-container"),email_extra_fields:b.find(".email_data_extra_fields .op-multirow-container")},g.els.email_extra_fields.data("multirow_counter",g.els.email_extra_fields.find(".op-multirow").length),g.els.extra_fields.data("multirow_counter",g.els.extra_fields.find(".op-multirow").length),g.$t.find(".integration_type_select").change(function(d){var e,h,i=a(this).val();switch(a(".op-signup_form-form_html").removeClass("op-signup_form-form_html_email"),i){case"email":a(".op-signup_form-form_html").addClass("op-signup_form-form_html_email"),e="p.email_data_field,div.email_data_field,.form_html_info_field",h="div.field-signup-form-id,div.field-double-optin,p.field-welcome-email,p.form_html_field,div.form_html_field,p.provider_list,p.thank_you_page,p.action_page,div.provider_list_note,p.already_subscribed_url,p.provider_autoresponder_name";break;case"custom":case"oneshoppingcart":h="div.field-signup-form-id,div.field-double-optin,p.field-welcome-email,p.email_data_field,div.email_data_field,p.provider_list,p.thank_you_page,p.action_page,div.provider_list_note,.form_html_info_field,p.already_subscribed_url,p.provider_autoresponder_name",e="p.form_html_field,div.form_html_field";break;case"infusionsoft":h="div.field-signup-form-id,div.field-double-optin,p.field-welcome-email,p.email_data_field,p.form_html_field,div.form_html_field,div.email_data_field,p.thank_you_page,p.provider_autoresponder_name",e="p.provider_list,p.name_html_field,div.extra_fields,p.action_page,div.provider_list_note,.form_html_info_field",c(i);break;case"mailchimp":h="div.field-signup-form-id,p.email_data_field,p.form_html_field,div.form_html_field,div.email_data_field,p.action_page,p.email_html_field,p.provider_autoresponder_name",e="div.field-double-optin,p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note,.form_html_info_field,p.already_subscribed_url",g.$t.find(".double_optin").is(":checked")?g.$t.find(".field-welcome-email").hide():g.$t.find(".field-welcome-email").show(),c(i);break;case"activecampaign":case"emma":h="div.field-double-optin,p.field-welcome-email,p.form_html_field,div.form_html_field,div.email_data_field,p.email_data_field,p.action_page,p.email_html_field,p.provider_autoresponder_name",e="div.field-signup-form-id,p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note,.form_html_info_field,p.already_subscribed_url",c(i);break;case"aweber":case"getresponse":case"icontact":case"campaignmonitor":case"constantcontact":case"mailpoet":h="div.field-signup-form-id,div.field-double-optin,p.field-welcome-email,p.form_html_field,div.form_html_field,div.email_data_field,p.email_data_field,p.action_page,p.email_html_field,p.provider_autoresponder_name",e="p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note,.form_html_info_field,p.already_subscribed_url",c(i);break;case"convertkit":h="div.field-signup-form-id,div.field-double-optin,div.extra_fields,p.already_subscribed_url,p.field-welcome-email,p.form_html_field,div.form_html_field,div.email_data_field,p.email_data_field,p.action_page,p.email_html_field,p.provider_autoresponder_name",e="p.provider_list,p.name_html_field,p.thank_you_page,div.provider_list_note,.form_html_info_field",c(i);break;case"egoi":h="div.field-double-optin,p.field-welcome-email,div.field-signup-form-id,p.email_data_field,p.form_html_field,div.form_html_field,div.email_data_field,p.action_page,p.email_html_field,p.provider_autoresponder_name",e="p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note,.form_html_info_field,p.already_subscribed_url",c(i);break;case"officeautopilot":case"ontraport":case"maropost":h="div.field-signup-form-id,div.field-double-optin,p.field-welcome-email,p.form_html_field,div.form_html_field,div.email_data_field,p.action_page,p.email_html_field,p.already_subscribed_url,p.provider_autoresponder_name",e="p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note,.form_html_info_field",c(i);break;case"arpreach":h="p.provider_list,div.provider_list_note,div.field-signup-form-id,div.field-double-optin,p.field-welcome-email,p.form_html_field,div.form_html_field,div.email_data_field,p.action_page,p.email_html_field",e="p.name_html_field,p.thank_you_page,div.extra_fields,.form_html_info_field,p.already_subscribed_url,p.provider_autoresponder_name",a.post(OptimizePress.ajaxurl,{action:OptimizePress.SN+"-email-provider-item-fields",provider:i,list:"arpreach"},function(a){g.lists.arpreach=a,f("arpreach",i)},"json")}g.$t.find(h).hide(),g.$t.find(e).show(),a.fancybox.update(),b.parent().height(b.height()),b.css({display:"none"}),setTimeout(function(){b.find(h).css({display:"none"}),b.find(e).css({display:"block"}),b.find(".disable_name").length>0&&(b.find(".disable_name")[0].checked===!0?b.find(".name_html_field").css({display:"none"}):b.find(".name_html_field").css({display:"block"})),b.css({display:"block"}),b.parent().height("auto")},0)}).trigger("change"),g.$t.find(".double_optin").change(function(a){g.$t.find(".double_optin").is(":checked")?g.$t.find(".field-welcome-email").hide():g.$t.find(".field-welcome-email").show()}),g.$t.find(".gotowebinar_enabled_select").change(function(b){var c=g.$t.find(".gotowebinar_list_field");"Y"==a(this).val()?c.show():c.hide()}).trigger("change"),g.$t.find(".provider_list_select").change(function(){var b=a(this).val();if("string"!=typeof b&&(a(this).val(a(this).find("option:first").val()),b=a(this).val()),g.input_elems={},"undefined"!=typeof g.lists[b]){var c=g.$t.find(".integration_type_select").val();"undefined"==typeof g.lists[b].fields?a.ajax({type:"POST",url:OptimizePress.ajaxurl,data:{action:OptimizePress.SN+"-email-provider-item-fields",provider:c,list:b},success:function(a){g.lists[b].fields=a.fields,g.lists[b].action=a.action,g.lists[b].hidden=a.hidden,f(b,c)},dataType:"json"}):f(b,c)}}),g.$t.find('.form_html_field_hidden input[type="checkbox"]').change(function(){var b=a(this).closest(".op-multirow").find(".form_html_field_text label");a(this).is(":checked")?b.html(op_mod_signup_form.lang.value):b.html(op_mod_signup_form.lang.text)}).trigger("change"),g.$t.find(".form_html").change(function(){var b=g.tmp_obj;g.input_elems={};try{b.html(a(this).val().replace(/<!--.*-->/g,"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<script.*/gi,""))}catch(c){}var f=b.find("form[action]");g.els.method.val(""),g.els.action.val(""),g.selects.find("option").remove(),g.hdn_div.html(""),f.length>0&&(a("input[name]:not(:button,:submit)",f).each(function(){var b=a(this).attr("name"),c=b==g.els.name_selected?' selected="selected"':"",d=b==g.els.email_selected?' selected="selected"':"";g.els.name_select.append('<option value="'+b+'"'+c+">"+b+"</option>"),g.els.email_select.append('<option value="'+b+'"'+d+">"+b+"</option>"),g.input_elems[b]=b}),"undefined"!=typeof g.input_elems.name&&g.els.name_select.val("name"),"undefined"!=typeof g.input_elems.email&&g.els.email_select.val("email"),a(":input",g.tmp_obj).each(function(){var b=a(this).attr("name");"undefined"!=typeof b&&(g.hdn_div.append(a('<input type="hidden" name="'+g.prefix+'[fields][field_name][]" />').val(b)),g.hdn_div.append(a('<input type="hidden" name="'+g.prefix+'[fields][field_vals][]" />').val(a(this).val())))}),g.els.action.val(f.attr("action")),g.els.method.val((f.attr("method")||"post").toLowerCase()),d(g.els.name_select),e())}).keyup(function(){a(this).trigger("change")}).trigger("change"),g.$t.find(".disable_name").change(function(){g.$t.find(".name_input").parent().toggle(!a(this).is(":checked")),g.$t.find(".name_order").parent().toggle(!a(this).is(":checked")),g.$t.find(".name_required").parent().toggle(!a(this).is(":checked"))}).trigger("change"),g.els.extra_fields.on("change","select",function(){var b=a(this).val(),c="hide",d=!1,e=a(this).parent().next();("op_add_new_field"==b||""==b)&&(c="show",d=!0),e[c](),d&&e.find(":input").focus()}).add(g.els.email_extra_fields).on("click",'a[href$="#remove"]',function(b){b.preventDefault(),a(this).closest(".op-multirow").remove()}),g.els.extra_fields.find(".op-multirow").each(function(){var b=a(this).find('input[name="selected_value"]');b.length>0&&a(this).find("select").val(b.val()).trigger("change")}),g.els.extra_fields.next().click(function(a){a.preventDefault();var b=g.els.extra_fields.data("multirow_counter");b++,g.els.extra_fields.data("multirow_counter",b);var c=g.idprefix+"extra_field_"+b+"_";g.els.extra_fields.append('<div class="op-multirow cf"><div><label for="'+c+'field_name">'+op_mod_signup_form.lang.field_name+'</label><select name="'+g.prefix+'[extra_fields][field_name][]" id="'+c+'field_name"><option value="op_add_new_field">'+op_mod_signup_form.lang.add_new_field+'</option><option value="">-----------------</option></select></div><div><input type="text" name="'+g.prefix+'[extra_fields][title][]" id="'+c+'title" /></div><div class="form_html_field_with_order"><label for="'+c+'text">'+op_mod_signup_form.lang.text+'</label><input type="text" name="'+g.prefix+'[extra_fields][text][]" id="'+c+'text" /></div><div class="form_html_field_order"><label for="'+c+'order">'+op_mod_signup_form.lang.order+'</label><input type="text" name="'+g.prefix+'[extra_fields][order][]" id="'+c+'order" /></div><div class="form_html_field_required"><label for="'+c+'required">'+op_mod_signup_form.lang.required+'</label><input type="checkbox" name="'+g.prefix+'[extra_fields][required][]" id="'+c+'required" /></div><div class="op-multirow-controls"><a href="#remove" class="remove-row"><img alt="'+op_mod_signup_form.lang.remove+'" src="'+OptimizePress.imgurl+'remove-row.png" /></a></div></div>').find("div.op-multirow:last select").trigger("change"),e()}),g.els.email_extra_fields.next().click(function(a){a.preventDefault();var b=g.els.email_extra_fields.data("multirow_counter");b++,g.els.email_extra_fields.data("multirow_counter",b);var c=g.idprefix+"email_extra_field_"+b;g.els.email_extra_fields.append('<div class="op-multirow cf"><div class="form_html_field_with_order"><label for="'+c+'">'+op_mod_signup_form.lang.text+'</label><input type="text" name="'+g.prefix+'[email_extra_fields][]" id="'+c+'" /></div><div class="form_html_field_order"><label for="'+c+'order">'+op_mod_signup_form.lang.order+'</label><input type="text" name="'+g.prefix+'[email_extra_fields_order][]" id="'+c+'order" /></div><div class="form_html_field_required"><label for="'+c+'required">'+op_mod_signup_form.lang.required+'</label><input type="checkbox" name="'+g.prefix+'[email_extra_fields_required][]" id="'+c+'required" /></div><div class="op-multirow-controls"><a href="#remove" class="remove-row"><img alt="'+op_mod_signup_form.lang.remove+'" src="'+OptimizePress.imgurl+'remove-row.png" /></a></div></div>').find("div.op-multirow:last input").focus()})};a(document).ready(function(){a(".op-signup_form-form_html").each(function(){new c(a(this))}),a(".module-signup_form .color_scheme_selector").change(function(){var c=a(this),d=a(this).closest(".tab-color_scheme"),e=d.find(".section_name").val();"undefined"!=typeof op_mod_signup_form.styles[e]&&b(d.find(".preview"),op_mod_signup_form.styles[e][c.val()].preview)}).trigger("change"),a(".opm_integration_select").change(function(){var b=a(this).parent().next(),c=b.next();"Y"===a(this).val()?(b.show(),c.show()):(b.hide(),c.hide())}).trigger("change")})}(opjq);