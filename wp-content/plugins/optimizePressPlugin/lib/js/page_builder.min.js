!function(a){function b(){var b,c=a(".op-content-slider-button");c.each(function(){b=a(this);var c=a("#"+a(this).data("target"));a(this).unbind("click").click(function(a){c.css({top:"0"}),a.preventDefault()}),c.find(".hide-the-panda").unbind("click").click(function(a){c.css({top:"-100%"}),a.preventDefault()}),c.on("click","ul.op-image-slider-content li a",function(d){var e=b.next("input.op-gallery-value"),f=(e.next(".file-preview").find(".content"),a(this).attr("src")),g='<a class="preview-image" target="_blank" href="'+f+'"><img alt="uploaded-image" src="'+f+'"></a><a class="remove-file button" href="#remove">Remove Image</a>';e.val(f),e.parent().next(".op-file-uploader").find(".file-preview .content").empty().html(g).find(".remove-file").click(function(){a(this).parent().empty().parent(".file-preview").prev(".op-uploader-value").val("")}),c.css({top:"-100%"}),d.preventDefault()})})}function c(){var b=a(this).val(),c="";c=b.replace(/\s/g,"-").replace(/[^a-zA-Z0-9\-]/g,"").replace(RegExp("-{2,}","g"),"-"),a("#op_page_slug").val(c.toLowerCase())}function d(b,c,d){b.empty(),"category"==d?(b.append(a("<option>").text("").val("")),a.each(h,function(d){var e=h[d];e.parent==="parent-"+c&&b.append(a("<option>").text(e.text).val(e.value))})):(b.append(a("<option>").text("").val("")),a.each(i,function(d){var e=i[d];e.parent==="parent-"+c&&b.append(a("<option>").text(e.text).val(e.value))})),b.val(""),"#op_category_id"==b.selector&&a("#op_category_id").trigger("change"),"#op_category_id1"==b.selector&&a("#op_category_id1").trigger("change")}var e=!1,f=!1,g=["productName","templates","layoutSelector","pageType","category","subcategory","content"],h=[],i=[],j={step_1:function(){var d=a(".form-actions-content .op-pb-button");a("body").on("change",'#content_layout_container input[type="radio"]',function(){a(this).closest("#content_layout_container").find(".img-radio-selected").removeClass("img-radio-selected").end().end().closest(".img-radio-item").addClass("img-radio-selected")}).filter(":checked").trigger("change"),a("body").on("click",".img-radio-label",function(){a(this).closest(".img-radio-item").find(":radio").attr("checked",!0).trigger("change")});var g,h=this,i=a("#op_ajax_checker"),j=i.find("img"),k=i.find('a[href$="#check"]'),l=i.find('a[href$="#cancel"]'),m=i.find("span.error"),n=i.find("span.success");h.submit(function(b){d.addClass("op-loading"),""==a.trim(a("#op_page_name").val())?(alert(OP_PageBuilder.name_message),a("#op_page_name").addClass("error").focus(),d.removeClass("op-loading"),b.preventDefault()):e||(f=!0,k.trigger("click"),b.preventDefault())}),a("#op_page_name").keyup(c).change(c),k.click(function(b){b.preventDefault(),d.addClass("op-loading"),k.fadeOut("fast",function(){m.add(n).hide(),j.add(l).fadeIn("fast"),g=a.ajax(OptimizePress.ajaxurl,{data:{action:OptimizePress.SN+"-page-builder-slug",slug:a("#op_page_slug").val(),post_id:OP_PageBuilder.post_id},type:"post",dataType:"json",success:function(b){if(l.add(j).fadeOut("fast",function(){k.fadeIn("fast")}),b.valid===!0)a("#op_page_slug").removeClass("error"),e=!0,f?(window.parent.OptimizePress.reload_page=!0,h.trigger("submit")):d.removeClass("op-loading"),m.hide(),n.show();else{var c=a("#op_page_slug").addClass("error");d.removeClass("op-loading"),f&&(alert(OP_PageBuilder.slug_message),c.focus()),e=!1,f=!1,n.hide(),m.show()}}})})}),l.click(function(a){a.preventDefault(),g.abort(),n.add(m).hide(),l.add(j).fadeOut("fast",function(){k.fadeIn("fast")})});var o=a("#preset-option-preset,#preset-option-content_layout");a("#preset-option :radio").change(function(){o.hide(),a(this).is(":checked")&&(v=a(this).val())&&"blank"!=v&&a("#preset-option-"+v).show()}).filter(":checked").trigger("change");var p=[a("#content_layout_container"),a("#upload_new_layout_container")];a("#upload_new_layout").click(function(a){a.preventDefault(),p[0].fadeOut("fast"),p[1].fadeIn("fast")}),a("#view_layouts").click(function(a){a.preventDefault(),p[1].fadeOut("fast"),p[0].fadeIn("fast")}),b()},step_2:function(){var b=a(".form-actions-content .op-pb-button");b.on("click",function(){b.addClass("op-loading")})},step_3:function(){function b(b){for(var c=0;c<g.length;c++)a("#"+g[c]).hide();for(var c=0;c<b.length;c++)-1!==a.inArray(b[c],g)&&a("#"+b[c]).fadeIn()}var c=this,e=a(".form-actions-content .op-pb-button");c.submit(function(a){e.addClass("op-loading")}),a("a.add-new","#op_product_field,#op_category_field,#op_subcategory_field").click(function(b){b.preventDefault();var c=a(this),d=c.parent(),e=d.siblings(".add-new"),f=e.find(":input").val("");c.prev().val(""),d.hide(),e.show(),f.focus()}),a("a.use-current","#op_product_field,#op_category_field,#op_subcategory_field").click(function(b){b.preventDefault();var c=a(this),d=c.parent(),e=d.siblings(".select"),f=e.find("select").val("");c.prev().val(""),d.hide(),e.show(),f.focus()}),a("#op_category_id").find("option").each(function(){h.push({value:a(this).val(),text:a(this).text(),parent:a(this).attr("class")})}),a("#op_subcategory_id").find("option").each(function(){i.push({value:a(this).val(),text:a(this).text(),parent:a(this).attr("class")})}),a("#op_product_id").change(function(){""!=a(this).val()&&a.ajax({type:"POST",dataType:"json",url:OptimizePress.ajaxurl,data:{productId:a(this).val(),action:OptimizePress.SN+"-live-editor-load-product"}}).done(function(b){void 0!=b.meta.dir&&a("#opThemeDir").val(b.meta.dir)}),d(a("#op_category_id"),a(this).val(),"category"),d(a("#op_category_id1"),a(this).val(),"category")}),a("#op_category_id").change(function(){d(a("#op_subcategory_id"),a(this).val(),"subcategory")}),a("#op_category_id1").change(function(){d(a("#op_subcategory_id"),a(this).val(),"subcategory")}),a("#opNewProduct").click(function(a){a.preventDefault(),b(["productName","templates","layoutSelector"])}),a("#opNewModule").click(function(a){a.preventDefault(),b(["pageType"])}),a("#pageTypeChange").change(function(){b([a(this).val(),"pageType"])});var f=a("#op_landing_options");f.length>0&&a(":radio","div.theme-select").change(function(){if(a(this).is(":checked")){var b=a(this).val(),c=a("#op_landing_themes_"+b);f.find(".theme-style-selection").hide(),c.length>0?(f.show(),c.show()):f.hide()}}).filter(":checked").trigger("change"),"undefined"!=typeof OP_PageBuilder.membership_types&&a(":radio","div.theme-select").change(function(){if(a(this).is(":checked")){var b=a(this).val(),c="content",d="",e="";switch("undefined"!=typeof OP_PageBuilder.membership_types[b]&&(c=OP_PageBuilder.membership_types[b]),c){case"content":d="#op_membership_options,#op_product_field,#op_category_field,#op_subcategory_field";break;case"product":e="#op_membership_options";break;case"category":d="#op_membership_options,#op_product_field",e="#op_category_field,#op_subcategory_field";break;case"subcategory":d="#op_membership_options,#op_product_field,#op_category_field",e="#op_subcategory_field"}""!=d&&a(d).show(),""!=e&&a(e).hide()}}).filter(":checked").trigger("change")},step_4:function(){var b=document.location.hash.split("#")[1];""!=b&&a('.op-bsw-grey-panel-tabs:first a[href$="#'+b+'"]').trigger("click"),this.submit(function(b){a(".form-actions-content .op-pb-button").addClass("op-loading")}),a(".menu-position :radio","#op_page_layout_header").change(function(){var b=a(this),c="hide";b.is(":checked")&&"alongside"==b.val()&&(c="show"),a("#op_page_layout_header_nav_bar_alongside")[c]()}).filter(":checked").trigger("change"),a("#op_header_layout_nav_bar_alongside_enabled").change(function(){a("#advanced_colors_nav_bar_alongside").toggle(a(this).is(":checked"))}).trigger("change"),a("#op_footer_area_enabled").change(function(){a("#advanced_colors_footer").toggle(a(this).is(":checked"))}).trigger("change"),a("#op_header_layout_nav_bar_below_enabled").change(function(){a("#advanced_colors_nav_bar_below").toggle(a(this).is(":checked"))}).trigger("change"),a("#op_header_layout_nav_bar_above_enabled").change(function(){a("#advanced_colors_nav_bar_above").toggle(a(this).is(":checked"))}).trigger("change"),a("#op_content_layout_layouts_option_blank").change(function(){var b=a(this);b.is(":checked")&&a("#op_page_content_layout_layouts .content_layout .img-radio-selected").removeClass("img-radio-selected")}).trigger("change");var c=a(".op-pb-wizard .module-page_builder > .op-bsw-grey-panel-sidebar"),d=a(window),e=c.offset(),f=15;d.scroll(function(){var a=d.scrollTop();a>e.top?c.stop().animate({marginTop:a-e.top+f}):c.stop().animate({marginTop:0})}),a("#op_page_color_schemes_template :radio").change(function(){var b=a(this);if(b.is(":checked")&&"undefined"!=typeof OP_Color_Schemes[b.val()]){var c=OP_Color_Schemes[b.val()];for(var d in c){var e="#op_color_scheme_advanced_"+d+"_";for(var f in c[d])if("string"==typeof c[d][f])a(e+f).val(c[d][f]).trigger("change");else for(var g in c[d][f])a(e+f+"_"+g).val(c[d][f][g]).trigger("change")}}})}};return OptimizePress.op_page_builder?(a(document).ready(function(){for(var b=1;5>b;b++){var c=a(".form-step-"+b);if(c.length>0&&"undefined"!=typeof j["step_"+b]){j["step_"+b].apply(c,[]);break}}}),void(window.op_refresh_content_layouts=function(){a.post(OptimizePress.ajaxurl,{action:OptimizePress.SN+"-live-editor-load-layouts",_wpnonce:a("#_wpnonce").val(),pagebuilder:"Y"},function(b){"undefined"!=typeof b.error?alert(b.error):"undefined"!=typeof b.content_layout&&(a("#content_layout_container_list").html(b.content_layout),a("#view_layouts").trigger("click"))},"json")})):!1}(opjq);