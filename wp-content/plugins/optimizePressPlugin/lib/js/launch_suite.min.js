!function(a){function b(){a("body").on("click","#launch_suite_pages .add-new-page, #launch_suite_sales .add-new-page",function(b){b.preventDefault(),i=a(this).prev(),a('#toplevel_page_optimizepress a[href$="page=optimizepress-page-builder"]').trigger("click")})}function c(){a("body").on("click","#funnel_delete",function(b){var c=a("#funnel_select").val();return confirm("Are you sure you want to delete this funnel?")?(a.post(OptimizePress.ajaxurl,{action:OptimizePress.SN+"-launch-suite-delete",_wpnonce:a("#_wpnonce").val(),funnel_id:c},function(a){document.location.replace(document.location.href.replace("&funnel_id="+c,""))}),!1):!1}),a("body").on("click","#funnel_switch_create_new",function(b){b.preventDefault(),a("#launch_funnel_select:visible").fadeOut("fast",function(){a("#launch_funnel_new").fadeIn("fast")})}),a("body").on("click","#funnel_switch_select",function(b){b.preventDefault(),a("#launch_funnel_new:visible").fadeOut("fast",function(){a("#launch_funnel_select").fadeIn("fast")})}),a("body").on("click","#add_new_funnel",function(b){b.preventDefault();var c=a(this).next().find("img").fadeIn("fast"),d=a("#new_funnel").val(),e={action:OptimizePress.SN+"-launch-suite-create",_wpnonce:a("#_wpnonce").val(),funnel_name:d};a.post(OptimizePress.ajaxurl,e,function(b){c.fadeOut("fast"),"undefined"!=typeof b.error?alert(b.error):(a("#funnel_select").html(b.html).trigger("change"),document.location.reload())},"json")})}function d(){var b=1;h.find("> div.section-stage > div.op-bsw-grey-panel-header > h3 > a").each(function(){a(this).text(OptimizePress.launch_section_title.replace(/%1\$s/,b)),b++})}function e(b){return""==b?"":a("#op_gateway_key_enabled").is(":checked")?f(b,"gw",a("#op_launch_settings_gateway_key_key").val()):b}function f(a,b,c){return a+(-1!=a.indexOf("?")?"&":"?")+b+"="+encodeURIComponent(c)}function g(){var b=a(".op-content-slider-button");b.each(function(b,c){var d=a(this).parent().prev(".op-content-slider"),e=a(this);a(this).unbind("click").click(function(a){d.css({top:0}),a.preventDefault()}),d.find(".hide-the-panda").unbind("click").click(function(a){d.css({top:"-100%"}),a.preventDefault()}),d.delegate("ul.op-image-slider-content li a","click",function(b){var c=e.next("input.op-gallery-value"),f=(c.next(".file-preview").find(".content"),a(this).attr("src")),g='<a class="preview-image" target="_blank" href="'+f+'"><img alt="uploaded-image" src="'+f+'"></a><a class="remove-file button" href="#remove">Remove Image</a>';c.val(f),c.parent().next(".op-file-uploader").find(".file-preview .content").empty().html(g).find(".remove-file").click(function(){a(this).parent().empty().parent(".file-preview").prev(".op-uploader-value").val("")}).parent().parent(".file-preview").prev(".op-uploader-value").val(f),d.css({top:"-100%"}),b.preventDefault()})})}var h,i=null;a(document).ready(function(){h=a("#launch_suite_pages"),a("body").on("change","#funnel_select",function(){parseInt(a("#funnel_id").val())>0&&a(this).val()!=a("#funnel_id").val()&&(document.location.href=OptimizePress.launch_suite_url.replace(/&amp;/g,"&")+a(this).val())}).trigger("change"),h.sortable({items:"> div.section-stage",handle:"div.show-hide-panel",axis:"y",update:d}),h.find(".panel-controlx").iButton().end().on("change","select.value_page",function(b){var c=OptimizePress.launch_page_urls[a(this).val()]||"",d=a(this).find("option:selected").text(),f=a(this).parent().siblings(".tab-navigation_text").find(".active-link-text");""==a.trim(f.val())&&f.val(d),"(Select Page...)"==a.trim(f.val())&&f.val(""),a(this).parent().find("input.value_page_url").val(c).end().find("input.value_page_access_url").val(e(c))}).on("click","div.tab-delete_stage button",function(){a(this).closest(".section-stage").remove(),d()}),a('input[name="op[funnel_pages][sales][page_setup][open_sales_cart]"]').change(function(b){a(this).is(":checked")?(a('input[name="op[funnel_pages][sales][page_setup][hide_cart]"]').removeAttr("checked").trigger("change"),a("#hide_cart").hide()):a("#hide_cart").show()}).trigger("change"),a("#launch_suite_sales select.value_page").change(function(){var b=OptimizePress.launch_page_urls[a(this).val()]||"";a(this).parent().find("input.value_page_url").val(b).end().find("input.value_page_access_url").val(e(b))}).trigger("change"),a("#op_launch_settings_gateway_key_key").change(function(){h.find("select.value_page").trigger("change")}),a("#op_gateway_key_enabled").change(function(){h.find("select.value_page").trigger("change");var b=".gateway_off",c=".gateway_on";a(this).is(":checked")&&(b=".gateway_on",c=".gateway_off"),h.add("#launch_suite_sales").find(b).css("display","block").end().find(c).css("display","none")}).trigger("change");a("body").on("click","#launch_suite_add_section",function(c){c.preventDefault();var d=a("#launch_suite_new_item").html(),e=h.find("div.section-stage").length+1;d=d.replace(/9999/g,e).replace(/# TITLE #/gi,OptimizePress.launch_section_title.replace(/%1\$s/,e)),h.append(d).find("div.section-stage:last").find("ul.op-bsw-grey-panel-tabs").op_tabs().end().find(".panel-controlx").iButton().end().find("select.value_page").trigger("change"),a("#op_gateway_key_enabled").trigger("change"),b(),g()}),b(),c(),g()}),window.op_launch_suite_update_selects=function(b){var c={action:OptimizePress.SN+"-launch-suite-refresh_dropdown",_wpnonce:a("#_wpnonce").val(),funnel_id:a("#funnel_id").val()};a.post(OptimizePress.ajaxurl,c,function(c){"undefined"!=typeof c.error?alert(c.error):(a(".landing_page,.value_page,#launch_suite_sales select,#launch_suite_new_item select").each(function(){var b=a(this).val();a(this).html(c.html).val(b)}),null!==i&&i.val(b))},"json")}}(opjq);