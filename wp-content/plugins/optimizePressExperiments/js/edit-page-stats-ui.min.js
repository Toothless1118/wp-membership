!function(a){a(document).ready(function(){function b(){var b=this;this.init=function(c){var d=b.initLineChart("#page_views",c);this.initDateRangePicker("#op-page-stats-daterange").bind("datepicker-closed",function(c,e){var f=a(c.currentTarget).val().split(" - "),g=a(c.currentTarget).attr("data-page-id");b.getPageStats(g,f[0],f[1]).then(function(c){a("#op-stats-page-sum-views").html(c.data.stats.sum.views),a("#op-stats-page-sum-unique").html(c.data.stats.sum.unique),a("#op-stats-page-sum-conversions").html(c.data.stats.sum.conversions),a("#op-stats-page-sum-conversion-rate").html(c.data.stats.sum.conversion_rate+"%"),d.destroy(),d=b.initLineChart("#page_views",c.data.stats)})})},this.initDateRangePicker=function(b){return a(b).dateRangePicker({separator:" - ",autoClose:!0,showShortcuts:!0,shortcuts:{"prev-days":[7,30],"next-days":null,next:null,prev:["week","month"]}})},this.initLineChart=function(b,c){return new Chart(a(b).get(0).getContext("2d"),{type:"line",data:{labels:c.labels,datasets:[{label:"Views",backgroundColor:OpChartOptions.colors.light[0],borderColor:OpChartOptions.colors.dark[0],data:c.views,lineTension:0},{label:"Unique",backgroundColor:OpChartOptions.colors.light[1],borderColor:OpChartOptions.colors.dark[1],data:c.unique,lineTension:0},{label:"Conversions",backgroundColor:OpChartOptions.colors.light[2],borderColor:OpChartOptions.colors.dark[2],data:c.conversions,lineTension:0}]},options:{animation:!1}})},this.getPageStats=function(b,c,d){return a.ajax({url:OptimizePress.ajaxurl+"?action=op-page-stats-get-page",type:"GET",data:{page_id:b,start_date:c,end_date:d},dataType:"json"})}}var c=new b;c.init(opInitialPageStats)})}(opjq);